<!-- Chosen Palette: Warm Neutrals (Zinc/Stone) with Indigo Accent -->
<!-- Application Structure Plan: A 3-Stage Interactive Dashboard structure is chosen to guide the user logically through the setup process defined in the guide (Sheet/Backend, Frontend, Hosting/Deployment). This structure is superior to a linear report-like view because it allows users to jump between the functional components (e.g., checking the data flow logic while looking at the deployment settings) based on their current task (debugging or building). Key interactions include global navigation tabs, data comparison selectors, and interactive checklists. -->
<!-- Visualization & Content Choices:
- Process Flow Diagram: Report Info -> Overall Process -> Goal -> Organize -> Viz/Presentation Method -> HTML/CSS Blocks -> Interaction -> Global Navigation Tabs -> Justification -> Clearly segment the 3 complex parts of the process. -> Library/Method - HTML/CSS/JS Nav
- Dynamic Bar Chart (Latency): Report Info -> Read vs Write Mechanism -> Goal -> Compare -> Viz/Presentation Method -> Dynamic Bar Chart -> Interaction -> Selector (Read/Write Toggle) -> Justification -> Visually emphasize the difference in complexity/security between the two API methods. -> Library/Method - Chart.js/Canvas
- Sheet Structure Matrix: Report Info -> Sheet Tabs (ReadData/WriteLog) -> Goal -> Organize, Inform -> Viz/Presentation Method -> HTML/CSS Matrix/Table -> Interaction -> Button Toggle -> Justification -> Clearly separates the purpose and required columns of the two essential tabs. -> Library/Method - HTML/CSS/JS Toggle
- Configuration Checklist: Report Info -> Configuration Variables -> Goal -> Inform, Checklist -> Viz/Presentation Method -> Interactive Checklist -> Interaction -> Click to highlight/reveal context -> Justification -> Addresses the common failure point (unconfigured variables) interactively. -> Library/Method - HTML/JS
- Deployment Steps: Report Info -> Deployment Steps -> Goal -> Organize, Inform -> Viz/Presentation Method -> Accordion/Timeline -> Interaction -> Click to expand details -> Justification -> Breaks down the necessary sequence of actions for GitHub/Apps Script. -> Library/Method - HTML/JS
-->
<!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Deployment Architecture</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* Stone-100 light background */
        }
        .section-content {
            min-height: 400px;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px; /* Max-width constraint for readability */
            margin-left: auto;
            margin-right: auto;
            height: 350px; /* Controlled height */
            max-height: 400px;
            background-color: #ffffff;
            padding: 1rem;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 380px;
            }
        }
    </style>
</head>
<body class="antialiased text-gray-800">

<!-- Header and Navigation -->
<header class="bg-white shadow-lg sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-4">
        <h1 class="text-3xl font-extrabold text-indigo-700">The 3-Stage Interactive Deployment Guide</h1>
        <p class="text-sm text-gray-500 mb-4">Explore the architecture for a GitHub-hosted, Google Sheet-driven Read/Write Web App.</p>
    </div>
    <nav class="border-t border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex space-x-2 sm:space-x-4" id="main-nav">
                <button data-target="stage1" class="nav-link py-3 px-3 sm:px-6 text-sm font-medium border-b-2 border-indigo-600 text-indigo-600 transition duration-150 ease-in-out">
                    1. Backend & Data Flow
                </button>
                <button data-target="stage2" class="nav-link py-3 px-3 sm:px-6 text-sm font-medium border-b-2 border-transparent text-gray-500 hover:text-indigo-600 hover:border-gray-300 transition duration-150 ease-in-out">
                    2. Frontend Implementation
                </button>
                <button data-target="stage3" class="nav-link py-3 px-3 sm:px-6 text-sm font-medium border-b-2 border-transparent text-gray-500 hover:text-indigo-600 hover:border-gray-300 transition duration-150 ease-in-out">
                    3. Hosting & Deployment
                </button>
            </div>
        </div>
    </nav>
</header>

<!-- Main Content Area -->
<main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">

    <!-- Stage 1: Backend & Data Flow -->
    <section id="stage1" class="section-content">
        <h2 class="text-3xl font-bold text-gray-900 mb-4">Stage 1: Backend & Data Flow Setup</h2>
        <p class="mb-8 text-gray-600">
            This section details the critical initial steps involving Google Sheets and the Google Apps Script (GAS) that serves as your secure, serverless backend. Understanding the dual-sheet structure and the functional difference between the Read (GET) and Write (POST) methods is key to avoiding the 404 errors encountered previously.
        </p>

        <div class="grid md:grid-cols-2 gap-8">
            <div class="bg-white p-6 rounded-xl shadow-md">
                <h3 class="text-xl font-semibold mb-3 border-b pb-2 text-indigo-700">Live Data from Sheet</h3>
                <button onclick="fetchSheetData()" class="mb-4 bg-indigo-600 text-white px-4 py-2 rounded shadow hover:bg-indigo-700">Refresh Data</button>
                <div id="live-data-container" class="overflow-x-auto text-sm">
                    <p class="text-gray-400">Click refresh to load data...</p>
                </div>
            </div>

            <div class="bg-white p-6 rounded-xl shadow-md">
                <h3 class="text-xl font-semibold mb-3 border-b pb-2 text-indigo-700">Submit New Entry</h3>
                <form id="dataForm" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Name</label>
                        <input type="text" id="userName" name="name" class="w-full p-2 border rounded" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Message</label>
                        <textarea id="userMessage" name="message" class="w-full p-2 border rounded" required></textarea>
                    </div>
                    <button type="submit" class="w-full bg-green-600 text-white py-2 rounded font-bold hover:bg-green-700">Submit to Google Sheet</button>
                </form>
                <div id="responseMessage" class="mt-4 text-center hidden"></div>
            </div>
        </div>
    </section>

    <!-- Stage 2: Frontend Implementation -->
    <section id="stage2" class="section-content hidden pt-10">
        <h2 class="text-3xl font-bold text-gray-900 mb-4">Stage 2: Frontend Implementation (index.html)</h2>
        <p class="mb-8 text-gray-600">
            The frontend's primary job is to correctly point its requests to the right backend endpoints. This section focuses on the three critical variables you must configure and how they enable the dual-functionality within the single HTML file.
        </p>

        <div class="grid md:grid-cols-2 gap-8">
            <!-- 2.1 Configuration Checklist -->
            <div class="bg-white p-6 rounded-xl shadow-md">
                <h3 class="text-xl font-semibold mb-3 border-b pb-2">Critical Variable Configuration</h3>
                <p class="text-sm text-gray-500 mb-4">Click on a variable to see where its value comes from in the deployment process.</p>
                <ul id="config-list" class="space-y-4">
                    <li class="p-3 bg-gray-100 rounded-lg cursor-pointer hover:bg-indigo-50 transition duration-150" data-var="SPREADSHEET_ID">
                        <code class="font-mono text-indigo-700 font-bold">SPREADSHEET_ID</code>
                        <p class="text-xs text-gray-600 mt-1">Unique identifier for the entire Google Sheet file.</p>
                    </li>
                    <li class="p-3 bg-gray-100 rounded-lg cursor-pointer hover:bg-indigo-50 transition duration-150" data-var="READDATA_GID">
                        <code class="font-mono text-indigo-700 font-bold">READDATA_GID</code>
                        <p class="text-xs text-gray-600 mt-1">Unique identifier for the specific 'ReadData' tab.</p>
                    </li>
                    <li class="p-3 bg-gray-100 rounded-lg cursor-pointer hover:bg-indigo-50 transition duration-150" data-var="GAS_WEB_APP_URL">
                        <code class="font-mono text-indigo-700 font-bold">GAS_WEB_APP_URL</code>
                        <p class="text-xs text-gray-600 mt-1">The secure API endpoint for the **Write** operation (Google Apps Script).</p>
                    </li>
                </ul>
            </div>

            <!-- 2.2 Variable Context Display -->
            <div class="bg-gray-800 p-6 rounded-xl shadow-md text-white">
                <h3 class="text-xl font-semibold mb-3 border-b border-gray-600 pb-2">Variable Source & Location</h3>
                <div id="variable-context" class="font-mono text-sm space-y-4">
                    <p class="text-gray-400">Select a variable on the left to view its source and deployment role.</p>
                    <div id="context-content">
                        <!-- Detailed context updated by JS -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Stage 3: Hosting & Deployment -->
    <section id="stage3" class="section-content hidden pt-10">
        <h2 class="text-3xl font-bold text-gray-900 mb-4">Stage 3: Hosting & Deployment Checklist</h2>
        <p class="mb-8 text-gray-600">
            Deployment is the final stage, requiring coordination between GitHub for static hosting and the Apps Script console for activating the backend API. Follow these steps sequentially to ensure the Read and Write functions are correctly enabled globally.
        </p>

        <div class="space-y-4 max-w-3xl mx-auto" id="deployment-accordion">
            <!-- Apps Script Deployment -->
            <div class="bg-white rounded-xl shadow-md overflow-hidden">
                <button class="w-full text-left p-4 font-semibold text-lg bg-indigo-100 text-indigo-800 flex justify-between items-center accordion-header">
                    Apps Script Deployment (Enabling POST)
                    <span class="text-xl transition-transform duration-300 transform rotate-0" data-icon="1">â–¶</span>
                </button>
                <div class="accordion-content p-4 border-t border-indigo-200 hidden">
                    <ul class="list-disc list-inside space-y-2 text-gray-700">
                        <li>Click **Deploy** &gt; **New deployment**.</li>
                        <li>Select type: **Web app**.</li>
                        <li>Execute as: **Me** (to use your Sheet permissions).</li>
                        <li>Who has access: **Anyone** (to allow the GitHub page to call it).</li>
                        <li>**CRITICAL:** Copy the **Web app URL** and paste it into the `GAS_WEB_APP_URL` variable in your `index.html`.</li>
                    </ul>
                </div>
            </div>

            <!-- GitHub Pages Deployment -->
            <div class="bg-white rounded-xl shadow-md overflow-hidden">
                <button class="w-full text-left p-4 font-semibold text-lg bg-indigo-100 text-indigo-800 flex justify-between items-center accordion-header">
                    GitHub Pages Deployment (Enabling GET/Frontend)
                    <span class="text-xl transition-transform duration-300 transform rotate-0" data-icon="2">â–¶</span>
                </button>
                <div class="accordion-content p-4 border-t border-indigo-200 hidden">
                    <ul class="list-disc list-inside space-y-2 text-gray-700">
                        <li>Upload the fully configured `index.html` to your repository root.</li>
                        <li>Go to Repository **Settings** &gt; **Pages**.</li>
                        <li>Set **Source** to Deploy from a branch (`main` or `master`).</li>
                        <li>Set the folder to `/ (root)`.</li>
                        <li>Click **Save** and wait for the deployment URL to appear.</li>
                    </ul>
                </div>
            </div>

            <!-- Final Verification -->
            <div class="bg-white rounded-xl shadow-md overflow-hidden">
                <button class="w-full text-left p-4 font-semibold text-lg bg-indigo-100 text-indigo-800 flex justify-between items-center accordion-header">
                    Testing and Verification
                    <span class="text-xl transition-transform duration-300 transform rotate-0" data-icon="3">â–¶</span>
                </button>
                <div class="accordion-content p-4 border-t border-indigo-200 hidden">
                    <p class="text-gray-700 mb-2">After deployment, verify the two functions:</p>
                    <ul class="list-disc list-inside space-y-2 text-gray-700">
                        <li>**Read Test:** Check if the content blocks are displaying data from the `ReadData` sheet. (Success means Visualization API works).</li>
                        <li>**Write Test:** Submit the form in the `index.html`. Check your `WriteLog` sheet for the new entry. (Success means Apps Script API works).</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

</main>

<script>
    const SPREADSHEET_ID = '18eVT_iVcjfdbAjXWiNa_CNDDKhF8z6h6Tzthc0rNrK8';
<!--    const SPREADSHEET_ID = '1nFGRs-H6EJbkGtQ2fmzHPyXlWVk4VDwGZf6QrXPsCzg';-->
    const READDATA_GID = '0';
    const WRITE_GID = '1';
<!--    const GAS_WEB_APP_URL = 'https://script.google.com/macros/s/AKfycby1xFyb-vu1HuaA62Fh-C0QoRSPNe3cCuwLWwNHrDfl1Z1QI1g8-LAqQ4FA0ZXtVmEl/exec';-->
    const GAS_WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbxpcD753yd9GkFr3HBVTj94qt3k49pKM-DIHrwT5VEYPuMyuU2z_up9ds7fAJHtBxNM/exec';
    const navLinks = document.querySelectorAll('.nav-link');
    const sections = document.querySelectorAll('.section-content');
    const apiSelector = document.getElementById('api-selector');
    const sheetTableContainer = document.getElementById('sheet-table-container');
    const toggleRead = document.getElementById('toggle-read');
    const toggleWrite = document.getElementById('toggle-write');
    const configList = document.getElementById('config-list');
    const contextContent = document.getElementById('context-content');
    const accordionHeaders = document.querySelectorAll('.accordion-header');

    let apiChartInstance = null;
    let currentSheetView = 'read';

    // --- Data Definitions (Simulating Report Content) ---
    const sheetData = {
        read: {
            title: "ReadData (Display)",
            purpose: "Publicly readable data for site content via Google Visualization API.",
            columns: [{ name: "Title", usage: "Content Header" }, { name: "Description", usage: "Body Text" }, { name: "ImageURL", usage: "Media Asset" }]
        },
        write: {
            title: "WriteLog (Form Input)",
            purpose: "Private data log for form submissions via Google Apps Script (POST).",
            columns: [{ name: "Timestamp", usage: "Record Time" }, { name: "Name", usage: "User Input" }, { name: "Message", usage: "User Input" }]
        }
    };

    const apiData = {
        read: {
            complexity: 1,
            security: 1,
            desc: "The **Read (GET)** operation is low complexity, fast, and uses the public Google Visualization API. It is safe for display data but cannot be used for writing.",
            label: "Public GET (Read)",
            color: 'rgba(59, 130, 246, 0.8)'
        },
        write: {
            complexity: 3,
            security: 3,
            desc: "The **Write (POST)** operation is high complexity, requiring an intermediate Apps Script layer. It is secure because the sheet ID is hidden, preventing direct external write access.",
            label: "Secure POST (Write)",
            color: 'rgba(79, 70, 229, 0.8)'
        }
    };

    const variableContexts = {
        SPREADSHEET_ID: {
            source: "The full URL of your Google Sheet.",
            role: "Identifies the core data file for both Read (GET) and Write (POST) operations.",
            example: "// docs.google.com/spreadsheets/d/<span class='text-yellow-400'>1AbC...XyZ</span>/edit"
        },
        READDATA_GID: {
            source: "The URL parameter of the specific 'ReadData' tab.",
            role: "Targets the content of only the publicly visible tab for the Read operation.",
            example: "// docs.google.com/spreadsheets/d/.../edit#gid=<span class='text-yellow-400'>0</span>"
        },
        GAS_WEB_APP_URL: {
            source: "Generated upon successful deployment of the Apps Script.",
            role: "The destination for the frontend's POST request; enables the secure Write function.",
            example: "// script.google.com/macros/s/<span class='text-yellow-400'>AKfyc...W1W</span>/exec"
        }
    };

    // --- Core Functions ---

    function setActiveSection(targetId) {
        sections.forEach(section => {
            section.classList.add('hidden');
            section.scrollTop = 0;
        });
        document.getElementById(targetId).classList.remove('hidden');

        navLinks.forEach(link => {
            const isTarget = link.getAttribute('data-target') === targetId;
            link.classList.toggle('border-indigo-600', isTarget);
            link.classList.toggle('text-indigo-600', isTarget);
            link.classList.toggle('border-transparent', !isTarget);
            link.classList.toggle('text-gray-500', !isTarget);
        });
    }

    function renderSheetTable(type) {
        const data = sheetData[type];
        const activeRead = type === 'read' ? 'bg-indigo-100 text-indigo-700' : 'bg-gray-200 text-gray-700 hover:bg-indigo-100';
        const activeWrite = type === 'write' ? 'bg-indigo-100 text-indigo-700' : 'bg-gray-200 text-gray-700 hover:bg-indigo-100';

        toggleRead.className = `px-4 py-2 text-sm font-medium rounded-full transition duration-150 ${activeRead}`;
        toggleWrite.className = `px-4 py-2 text-sm font-medium rounded-full transition duration-150 ${activeWrite}`;

        sheetTableContainer.innerHTML = `
            <div class="p-4 bg-indigo-50 rounded-lg border border-indigo-200 mb-4">
                <p class="font-bold text-indigo-800">${data.title}</p>
                <p class="text-xs text-indigo-600">${data.purpose}</p>
            </div>
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Column</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Usage</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        ${data.columns.map(col => `
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${col.name}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${col.usage}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            </div>
        `;
        currentSheetView = type;
    }

    function createAPIChart() {
        const ctx = document.getElementById('apiChart').getContext('2d');
        const data = apiData[apiSelector.value];

        apiChartInstance = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Complexity Score', 'Security Score'],
                datasets: [{
                    label: data.label,
                    data: [data.complexity, data.security],
                    backgroundColor: [data.color, data.color],
                    borderColor: [data.color.replace('0.8', '1'), data.color.replace('0.8', '1')],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                indexAxis: 'y',
                scales: {
                    x: {
                        beginAtZero: true,
                        max: 5,
                        title: { display: true, text: 'Relative Score (1-5)' }
                    }
                },
                plugins: {
                    legend: { display: true, position: 'top' },
                    tooltip: {
                        callbacks: {
                            label: function(context) { return context.dataset.label + ': ' + context.parsed.x; }
                        }
                    }
                }
            }
        });
        document.getElementById('api-description').innerHTML = data.desc;
    }

    function updateAPIChart() {
        if (!apiChartInstance) {
            createAPIChart();
            return;
        }
        const data = apiData[apiSelector.value];
        apiChartInstance.data.labels = ['Complexity Score', 'Security Score'];
        apiChartInstance.data.datasets[0].data = [data.complexity, data.security];
        apiChartInstance.data.datasets[0].label = data.label;
        apiChartInstance.data.datasets[0].backgroundColor = [data.color, data.color];
        apiChartInstance.data.datasets[0].borderColor = [data.color.replace('0.8', '1'), data.color.replace('0.8', '1')];
        apiChartInstance.update();
        document.getElementById('api-description').innerHTML = data.desc;
    }

    function updateVariableContext(variable) {
        const context = variableContexts[variable];
        contextContent.innerHTML = `
            <p class="text-lg font-bold text-indigo-400 mb-2">${variable}</p>
            <div class="bg-gray-700 p-3 rounded-md">
                <p class="text-gray-300">Source:</p>
                <code class="text-sm block break-words">${context.source}</code>
            </div>
            <div class="bg-gray-700 p-3 rounded-md">
                <p class="text-gray-300">Role:</p>
                <code class="text-sm block">${context.role}</code>
            </div>
            <div class="bg-gray-700 p-3 rounded-md">
                <p class="text-gray-300">Example URL Segment:</p>
                <code class="text-sm block break-words">${context.example}</code>
            </div>
        `;
        // Highlight the active list item
        document.querySelectorAll('#config-list li').forEach(li => {
            li.classList.remove('bg-indigo-100', 'border-indigo-500', 'shadow-inner');
            li.classList.add('bg-gray-100', 'hover:bg-indigo-50');
        });
        const activeLi = document.querySelector(`#config-list li[data-var="${variable}"]`);
        if (activeLi) {
            activeLi.classList.remove('bg-gray-100', 'hover:bg-indigo-50');
            activeLi.classList.add('bg-indigo-100', 'border-indigo-500', 'shadow-inner');
        }
    }

    // --- Event Listeners and Initialization ---

    // Main Navigation
    navLinks.forEach(link => {
        link.addEventListener('click', (e) => setActiveSection(e.target.getAttribute('data-target')));
    });

    // Stage 1 Listeners (Sheet and API Chart)
    toggleRead.addEventListener('click', () => renderSheetTable('read'));
    toggleWrite.addEventListener('click', () => renderSheetTable('write'));
    apiSelector.addEventListener('change', updateAPIChart);

    // Stage 2 Listeners (Config Checklist)
    configList.querySelectorAll('li').forEach(li => {
        li.addEventListener('click', (e) => {
            const targetVar = e.currentTarget.getAttribute('data-var');
            updateVariableContext(targetVar);
        });
    });

    // Stage 3 Listeners (Accordion)
    accordionHeaders.forEach(header => {
        header.addEventListener('click', () => {
            const content = header.nextElementSibling;
            const icon = header.querySelector('span[data-icon]');
            const isHidden = content.classList.contains('hidden');

            document.querySelectorAll('.accordion-content').forEach(c => c.classList.add('hidden'));
            document.querySelectorAll('.accordion-header span[data-icon]').forEach(i => i.classList.remove('rotate-90'));

            if (isHidden) {
                content.classList.remove('hidden');
                icon.classList.add('rotate-90');
            } else {
                icon.classList.add('rotate-0');
            }
        });
    });

    // Initial setup
    document.addEventListener('DOMContentLoaded', () => {
        setActiveSection('stage1');
        renderSheetTable('read');
        createAPIChart();
        updateVariableContext('SPREADSHEET_ID'); // Default variable context
    });

    // --- ACTUAL DATA INTERACTION LOGIC ---

<!--// 1. FETCH DATA (READ)-->
<!--async function fetchSheetData() {-->
<!--    const container = document.getElementById('live-data-container');-->
<!--    container.innerHTML = "Loading...";-->

<!--    // Using the Visualization API to read public data-->
<!--    const url = `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/gviz/tq?tqx=out:json&gid=${READDATA_GID}`;-->

<!--    try {-->
<!--        const response = await fetch(url);-->
<!--        const text = await response.text();-->
<!--        // Remove the extra JSON framing from Google-->
<!--        const json = JSON.parse(text.substr(47).slice(0, -2));-->

<!--        let html = '<table class="min-w-full border"><thead><tr class="bg-gray-100">';-->
<!--        json.table.cols.forEach(col => html += `<th class="p-2 border">${col.label}</th>`);-->
<!--        html += '</tr></thead><tbody>';-->

<!--        json.table.rows.forEach(row => {-->
<!--            html += '<tr>';-->
<!--            row.c.forEach(cell => html += `<td class="p-2 border">${cell ? cell.v : ''}</td>`);-->
<!--            html += '</tr>';-->
<!--        });-->
<!--        html += '</tbody></table>';-->
<!--        container.innerHTML = html;-->
<!--    } catch (err) {-->
<!--        container.innerHTML = "<span class='text-red-500'>Error: Make sure Sheet is 'Anyone with link can view'</span>";-->
<!--    }-->
<!--}-->

<!--// 2. SUBMIT DATA (WRITE)-->
<!--document.getElementById('dataForm').addEventListener('submit', function(e) {-->
<!--    e.preventDefault();-->
<!--    const respDiv = document.getElementById('responseMessage');-->
<!--    respDiv.classList.remove('hidden');-->
<!--    respDiv.innerHTML = "Submitting...";-->

<!--    const formData = new FormData(this);-->
<!--    const data = Object.fromEntries(formData.entries());-->

<!--    // Send data to the Apps Script URL-->
<!--    fetch(GAS_WEB_APP_URL, {-->
<!--        method: 'POST',-->
<!--        mode: 'no-cors', // Required for Google Apps Script cross-domain-->
<!--        cache: 'no-cache',-->
<!--        headers: { 'Content-Type': 'application/json' },-->
<!--        body: JSON.stringify(data)-->
<!--    })-->
<!--    .then(() => {-->
<!--        respDiv.innerHTML = "<span class='text-green-600 font-bold'>Success! Data sent.</span>";-->
<!--        this.reset();-->
<!--        fetchSheetData(); // Refresh table-->
<!--    })-->
<!--    .catch(err => {-->
<!--        respDiv.innerHTML = "<span class='text-red-600'>Error: " + err + "</span>";-->
<!--    });-->
<!--});-->
// 1. THE READ FUNCTION (Uses Google Visualization API)
async function fetchSheetData() {
    const container = document.getElementById('live-data-container');
    container.innerHTML = "Fetching...";

    // This URL accesses your public sheet data
    const url = `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/gviz/tq?tqx=out:json&gid=${READDATA_GID}`;

    try {
        const response = await fetch(url);
        const text = await response.text();
        const json = JSON.parse(text.substr(47).slice(0, -2)); // Clean Google's JSON wrapper

        let tableHtml = '<table class="w-full border-collapse"><thead><tr class="bg-gray-100">';
        json.table.cols.forEach(col => tableHtml += `<th class="border p-2 text-left">${col.label || 'Column'}</th>`);
        tableHtml += '</tr></thead><tbody>';

        json.table.rows.forEach(row => {
            tableHtml += '<tr>';
            row.c.forEach(cell => tableHtml += `<td class="border p-2">${cell ? cell.v : ''}</td>`);
            tableHtml += '</tr>';
        });
        tableHtml += '</tbody></table>';
        container.innerHTML = tableHtml;
    } catch (e) {
        container.innerHTML = `<p class="text-red-500">Error: Make sure your Sheet is "Anyone with link can view".</p>`;
    }
}

// 2. THE WRITE FUNCTION (Talks to your doPost function)
document.getElementById('dataForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const btn = document.getElementById('submitBtn');
    const status = document.getElementById('formStatus');

    btn.disabled = true;
    btn.innerText = "Sending...";
    status.classList.remove('hidden');
    status.innerHTML = "Processing...";

    const payload = {
        name: document.getElementById('formName').value,
        message: document.getElementById('formMessage').value
    };

    fetch(GAS_WEB_APP_URL, {
        method: 'POST',
        mode: 'no-cors', // Crucial for Google Apps Script
        cache: 'no-cache',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
    })
    .then(() => {
        status.innerHTML = "âœ… Success! Row added to Sheet.";
        status.className = "mt-4 text-center text-sm text-green-600 font-bold";
        document.getElementById('dataForm').reset();
        fetchSheetData(); // Auto-refresh the list
    })
    .catch(err => {
        status.innerHTML = "âŒ Error: " + err;
        status.className = "mt-4 text-center text-sm text-red-600";
    })
    .finally(() => {
        btn.disabled = false;
        btn.innerText = "ðŸš€ Send to Google Sheet";
    });
});
</script>
</body>
</html>